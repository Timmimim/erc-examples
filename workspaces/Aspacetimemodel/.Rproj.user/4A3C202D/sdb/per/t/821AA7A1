{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Figure1_interactive\"\nauthor: \"Jennifer R. Marlon et al.\"\ndate: \"17 Oktober 2017\"\noutput: html_document\nruntime: shiny\n---\n\n```{r setup, echo=FALSE, message=FALSE, warning=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n\nlibrary(ggplot2)\nlibrary(\"dplyr\")\nload(\"mjoBestUse.RData\")\nlibrary(\"rgdal\")\nlibrary(\"raster\")\nlibrary(\"RColorBrewer\")\nlibrary(\"rasterVis\")\nlibrary(mapproj)\nlibrary(maptools)\nrequire(gridExtra)\nrequire(sp)\n\nsliderInput(\"intensity\", \"Intensity\", min = 1, max = 50, value = 30)\n\nrenderPlot({\n\nTracks.df = filter(Tracks.df, Int >= input$intensity) \n\nfullData.df = load(\"best.use.2014.Rdata\")\nbegin = 1975; end = 2014\n\nfullData.df = best.use %>%\n  mutate(Int = WmaxS * .5144, \n         DIntDt = DWmaxDt * .5144) %>%\n  filter(Yr >= begin, Yr <= end, Int >= 33.0, M == FALSE)\n\nll = \"+proj=longlat +ellps=WGS84\"\n\nTracks.sdf = Tracks.df\ncoordinates(Tracks.sdf) = c(\"lon\", \"lat\")\nproj4string(Tracks.sdf) = CRS(ll)\n\nfullData.sdf = fullData.df\ncoordinates(fullData.sdf) = c(\"lon\", \"lat\")\nproj4string(fullData.sdf) = CRS(ll)\n\nr = raster(ncol = 10, nrow = 5, \n           xmn = -100, xmx = -20, \n           ymn = 10, ymx = 50)\n\nTracks.grid = rasterize(Tracks.sdf, r,\n                        field = 'DIntDt',\n                        fun = mean)\n\ntest = rasterToPolygons(Tracks.grid)\n\nExample.sdf = subset(Tracks.sdf, \n                     Sid == 1675 | \n                     Sid == 1677 |\n                     Sid == 1683)\nExample.grid = rasterize(Example.sdf, r, \n                         field = 'DIntDt',\n                         fun = mean)\n\nrange(values(Example.grid), na.rm = TRUE)\nrng = seq(0, 1.5, 1.5)\nbreaks = c(0, 0.25, 0.50, 0.75, 1.0, 1.25, 1.50)\ncr = brewer.pal(9, \"Purples\")\ncr = cr[-(1:3)]\nvals = levelplot(Example.grid, margin = FALSE, \n          xlab = NULL, ylab = NULL, \n          col.regions = cr, at = rng, \n          colorkey = NULL,\n          border = \"white\", border.lwd = 2, pretty=TRUE,\n          par.settings = list(fontsize = list(text = 15)))\n\noutlines = as.data.frame(map(\"world\", xlim = c(-100, -20), \n                             ylim = c(10, 50), \n                             plot = FALSE)[c(\"x\", \"y\")],\n                             color = \"gray\")\nmap = geom_path(aes(x, y), inherit.aes = FALSE, data = outlines, \n                alpha = .8, show_guide = FALSE, color = \"blue\")\next = as.vector(extent(r))\nboundaries = map(\"world\", fill = TRUE, xlim = ext[1:2], \n                 ylim = ext[3:4], plot = FALSE)\nIDs = sapply(strsplit(boundaries$names, \":\"), function(x) x[1])\nbPols <<- map2SpatialPolygons(boundaries, IDs = IDs,\n                              proj4string = CRS(projection(r)))\n\n#This chunk produces Figure 1 from the article\n\nInt2a.df = filter(Tracks.df, Sid == 1675)\nInt2b.df = filter(Tracks.df, Sid == 1677)\nInt2c.df = filter(Tracks.df, Sid == 1683)\nholdera = data.frame(Int2a.df$lon, Int2a.df$lat)\nholderb = data.frame(Int2b.df$lon, Int2b.df$lat)\nholderc = data.frame(Int2c.df$lon, Int2c.df$lat)\nlinesa <<- SpatialLines(list(Lines(list(Line(holdera)),\n                                 ID = 'Int2a.df$Sid')))\nlinesb <<- SpatialLines(list(Lines(list(Line(holderb)),\n                                 ID = 'Int2b.df$Sid')))\nlinesc <<- SpatialLines(list(Lines(list(Line(holderc)),\n                                 ID = 'Int2c.df$Sid')))\n\n\ntracking = vals + layer(sp.polygons(bPols, col = gray(.8))) +\n  layer(sp.lines(linesa, lwd = 2, col = gray(.4))) + \n  layer(sp.lines(linesb, lwd = 2, col = gray(.4))) + \n  layer(sp.lines(linesc, lwd = 2, col = gray(.4))) +\n  layer(panel.text(-63.5, 27.5, 'Gustav', col = gray(.4))) +\n  layer(panel.text(-51, 16.5, 'Ike', col = gray(.4))) + \n  layer(panel.text(-81.5, 16.25, 'Omar', col = gray(.4)))\ntracking\n\n})\n```",
    "created" : 1508321899283.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2000594434",
    "id" : "821AA7A1",
    "lastKnownWriteTime" : 1508322483,
    "last_content_update" : 1508322483742,
    "path" : "C:/Users/m_konk01/sciebo/o2r-data/Korpus/Reproducing papers/Finished/Aspacetimemodel/Aspacetimemodel/figure1_interactive.Rmd",
    "project_path" : "figure1_interactive.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}